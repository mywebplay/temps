<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hướng dẫn lấy nội dung studocu</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      padding: 16px;
      box-sizing: border-box;
    }
    h2 {
      color: red;
    }
    h4 {
      color: black;
      margin-top: 8px;
    }
    img {
      width: 100%;
      max-height: calc(100vh - 250px);
      object-fit: contain;
      display: block;
      margin: 16px 0;
    }
    .step {
      display: none;
    }
    .active {
      display: block;
    }
    .code-container {
      position: relative;
      background: #f0f0f0;
      padding: 12px;
      border-radius: 6px;
      overflow: auto;
      margin-top: 10px;
    }
    pre {
      margin: 0;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .copy-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      background: #007bff;
      color: white;
      border: none;
      padding: 4px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 13px;
    }
    button {
      display: block;
      margin: 20px auto 0;
      padding: 10px 20px;
      font-size: 16px;
      background: #28a745;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    textarea {
      width: 100%;
      height: calc(100vh - 120px);
      margin-top: 16px;
      padding: 12px;
      font-size: 14px;
      box-sizing: border-box;
      resize: none;
    }
    .spinner {
      display: none;
      margin: 20px auto;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #555;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }
  </style>
</head>
<body>

  <div class="step active" id="step1">
    <h2>Bước 1</h2>
    <h4>Truy cập url của trang studocu.vn dẫn đến tài liệu bạn muốn lấy</h4>
    <img src="https://mywebplay.github.io/images/studocu/Buoc-1.jpg" alt="Step 1" />
    <button onclick="nextStep()">Tiếp tục</button>
  </div>

  <div class="step" id="step2">
    <h2>Bước 2</h2>
    <h4>Nhấn F12, sau đó qua tab Console, click chuột phải và chọn Clear console để làm sạch nội dung.</h4>
    <img src="https://mywebplay.github.io/images/studocu/Buoc-2.jpg" alt="Step 2" />
    <button onclick="nextStep()">Tiếp tục</button>
  </div>

  <div class="step" id="step3">
    <h2>Bước 3</h2>
    <h4>Sau đó gán dòng lệnh bên dưới vào console đó rồi nhấn Enter</h4>

    <div class="code-container">
      <button class="copy-btn" onclick="copyCode()">Copy</button>
      <pre id="code">
var bvl_content = document.getElementsByClassName("page-content");
var bvl_result = "";
for(var i = 0; i < bvl_content.length; i++) {
  bvl_result += bvl_content[i].outerHTML + "\n";
}
console.log(bvl_result);
      </pre>
    </div>

    <img src="https://mywebplay.github.io/images/studocu/Buoc-3.jpg" alt="Step 3" />
    <button onclick="nextStep()">Tiếp tục</button>
  </div>

  <div class="step" id="step4">
    <h2>Bước 4</h2>
    <h4>Click vào "Copy", sau đó quay trở lại đây để gán lại nội dung đó để có thể sử dụng.</h4>
    <img src="https://mywebplay.github.io/images/studocu/Buoc-4.jpg" alt="Step 4" />
    <button onclick="nextStep()">Tiếp tục</button>
  </div>

  <div class="step" id="step5">
    <textarea id="resultArea" placeholder="Dán nội dung bạn vừa copy vào đây..."></textarea>
    <button id="getResultBtn" onclick="getResult()">GET RESULT</button>
    <div class="spinner" id="loadingSpinner"></div>
  </div>

  <script>
    let currentStep = 1;

    function nextStep() {
      document.getElementById(`step${currentStep}`).classList.remove("active");
      currentStep++;
      document.getElementById(`step${currentStep}`).classList.add("active");
    }

    function copyCode() {
      const code = document.getElementById("code").innerText;
      navigator.clipboard.writeText(code);
      alert("Đã copy vào clipbaord của bạn !");
    }

    function getResult() {
	  const btn = document.getElementById("getResultBtn");
	  const spinner = document.getElementById("loadingSpinner");
	  const textarea = document.getElementById("resultArea");

	  // Vô hiệu hóa textarea
	  textarea.readOnly = true;

	  // Ẩn nút và hiện vòng quay loading
	  btn.style.display = "none";
	  spinner.style.display = "block";

	  // Chuẩn bị dữ liệu
	  const formData = new FormData();
	  formData.append("html", textarea.value);

	  // Gửi request
	  fetch("http://normalwebbasic.somee.com/Cover/GetTextInHtml", {
		method: "POST",
		body: formData,
	  })
		.then(response => response.json())
		.then(data => {
		  if (data && data.result) {
			textarea.value = data.result;
		  } else {
			textarea.value = "Không nhận được kết quả hợp lệ.";
		  }
		})
		.catch(error => {
		  console.error("Lỗi:", error);
		  textarea.value = "Đã xảy ra lỗi khi gửi dữ liệu.";
		})
		.finally(() => {
		  // Ẩn loading sau 10 giây
		  setTimeout(() => {
			spinner.style.display = "none";
		  }, 10000);
		});
	}

  </script>
</body>
</html>
